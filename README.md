<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [validated-attributes][1]
-   [Usage][2]
-   [Base Classes][3]
    -   [AttributeValidationError][4]
        -   [Parameters][5]
    -   [Attribute][6]
        -   [Parameters][7]
        -   [name][8]
        -   [flags][9]
        -   [default][10]
        -   [isOptional][11]
        -   [validate][12]
            -   [Parameters][13]
        -   [newDefault][14]
        -   [mergeDefault][15]
            -   [Parameters][16]
        -   [newSkeleton][17]
        -   [defaultsTo][18]
            -   [Parameters][19]
        -   [as][20]
            -   [Parameters][21]
        -   [with][22]
            -   [Parameters][23]
        -   [makeOptional][24]
        -   [\_clone][25]
        -   [\_copyAttrProps][26]
            -   [Parameters][27]
-   [Simple Attribute Classes][28]
    -   [FixedAttribute][29]
        -   [Parameters][30]
        -   [value][31]
        -   [valueType][32]
        -   [\_clone][33]
    -   [ObjectAttribute][34]
        -   [Parameters][35]
        -   [cls][36]
        -   [\_clone][37]
-   [Combined Attribute Classes][38]
    -   [EnumAttribute][39]
        -   [Parameters][40]
        -   [values][41]
        -   [\_clone][42]
    -   [TupleAttribute][43]
        -   [Parameters][44]
        -   [elements][45]
        -   [validate][46]
            -   [Parameters][47]
        -   [mergeDefault][48]
            -   [Parameters][49]
        -   [newSkeleton][50]
        -   [\_clone][51]
    -   [CompoundAttribute][52]
        -   [Parameters][53]
        -   [elementAttr][54]
        -   [ofType][55]
            -   [Parameters][56]
        -   [validate][57]
            -   [Parameters][58]
        -   [newSkeleton][59]
        -   [\_clone][60]
        -   [\_copyAttrProps][61]
            -   [Parameters][62]
    -   [SchemaAttribute][63]
        -   [Parameters][64]
        -   [fields][65]
        -   [validate][66]
            -   [Parameters][67]
        -   [mergeDefault][68]
            -   [Parameters][69]
        -   [newSkeleton][70]
        -   [\_clone][71]
-   [Functions][72]
    -   [validate][73]
        -   [Parameters][74]
    -   [isValid][75]
        -   [Parameters][76]
    -   [newDefault][77]
        -   [Parameters][78]
    -   [mergeDefault][79]
        -   [Parameters][80]
    -   [newSkeleton][81]
        -   [Parameters][82]
    -   [toAttribute][83]
        -   [Parameters][84]
    -   [typeofPlus][85]
        -   [Parameters][86]
-   [ValidatorFn][87]
-   [DefaultValue][88]
-   [ElementValidatorFn][89]
-   [ElementIterator][90]
-   [DetailedType][91]

## validated-attributes

Beta-quality declarative attributes validation library for JavaScript.


## Usage

The intended way of using this library is through importing it as `A` and then
using it declaratively. Like this, things will almost form a readable sentence.
After creating the Attribute objects, a call to `.validate(something)` will do
the job; an error is thrown on failure or the value is returned as-is on
success. The error can be inspected for your program logic to create appropriate
error messages towards the user. Should you only require a boolean value if the
validation succeeded, the `isValid()` helper function can be used.

The greatest power of this library is the way things can be re-used and
combined, which is most useful for schema attributes. See the example below.

## Example

```javascript
import A from 'validated-attributes';

const Address = A.schema({
  street: A.required.string,
  city: A.required.string,
  zip: A.required.string,
  country: A.required.string,
  state: A.optional.string,
});

const User = A.schema({
  firstName: A.required.string,
  lastName: A.required.string,
  email: A.required.string,
  privateAddress: Address,
  bizAddress: Address.makeOptional(),
});
```

## List of Pre-Defined Objects

All of the following can be used directly, i.e. `A.<name>`. or by prepending
"required", i.e. `A.required.<name>`, which is just for readability. In addition
to that, the objects can be found in an optional variant `A.optional.<name>`
which is most useful in schema Attributes. At any time, a required Attribute can
be turned into an optional Attribute by calling `.makeOptional()`, but note that
this will create a new object each time.

    A.string - Any string value
    A.nonemptyString - Any string that is not the empty string
    A.integerString - A string that consists of integer digits
    A.uuid - A string that represents an UUID (uses a RegExp)
    A.email - A string that represents an eMail address (uses a "close enough" RegExp)
    A.dateString - A string that represents a date in the form YYYY-MM-DD (uses a RegExp followed by Date.parse)

    A.boolean - Any boolean value
    A.number - Any number value
    A.integer - An integer number value
    A.regexp - Any RegExp object
    A.date - Any date object
    A.function - Any function object

    A.array - Any array value; can be customized, see CompoundAttribute.ofType
    A.map - Any object with values; can be customized, see CompoundAttribute.ofType

## List of Factory Functions

The following can also be used directly, as required and as optional, but rather
than being a fixed value, they are in fact functions that create an Attribute
object.

    A.fixed(v) - A fixed value, checked by ===

    A.tuple(elements) - A fixed-length array with elements of the given Attribute type
    A.schema(fields) - A plain object with the given Attribute fields

    A.instanceOf(cls) - An object of a specific class
    A.oneOf(...args) - The value can be a selection of Attributes; at least one should validate

## Defaults

Each Attribute object can produce a default value, that can be overridden by
calling `defaultsTo()` on the Attribute object. This will create a copy of the
Attribute object with the new default value set.

Either `newDefault()` or `mergeDefault()` can be used to produce a default
value. Compound Attribute objects will call this recursively on their inner
Attribute objects.

## Skeletons

In addition to a default value, a so-called skeleton value can be obtained
from an Attribute object. In almost all cases, this will return a `null` value,
but e.g. schema attributes will return an object with all fields set to either
`null` or - if a field is schema Attribute itself - a skeleton of the respective
type.


## Base Classes




### AttributeValidationError

**Extends ExtendableError**

Error class for validation errors

You might want to test a thrown error with `instanceof` against this class.

#### Parameters

-   `expected` **[string][92]** 
-   `got` **any** 
-   `optional` **[boolean][93]** 

### Attribute

Base class for attributes

You can inherit from this class to create custom validators; you must override
at least the `_clone` method.

#### Parameters

-   `validator` **[ValidatorFn][94]** 
-   `defaultsTo` **[DefaultValue][95]?** 

#### name

Name of the attribute; usually reflects its type

Type: [string][92]

#### flags

Arbitrary flags you can use for your application purposes

Type: {}

#### default

Default value of the attribute (function that creates a default or immutable
value)

Type: [DefaultValue][95]

#### isOptional

Whether this attribute is marked as optional; changes behavior of validate
and newSkeleton

Type: [boolean][93]

#### validate

Main method for validation

Throws `AttributeValidationError` on, you guessed it, validation errors.
Returns the validated object on success.

The default implementation calls the underlying validator function

Note: for use with flow type, cast the returned object to your target type.

##### Parameters

-   `input` **any** 

Returns **any** 

#### newDefault

Creates a new default value for this attribute

Returns the value set with `defaultsTo` or, if it is a function, invokes
it and returns its result.

Returns **any** 

#### mergeDefault

Merges the given value with the default of this attribute

Optionally treats `null` as `undefined` even for optional attributes.

Works best for schema or tuple attributes since it works recursively; it will
also remove any fields that are not specified in the schema (!)

##### Parameters

-   `value` **any** 
-   `nullIsUndefined` **[boolean][93]?** 

Returns **any** 

#### newSkeleton

Returns a new skeleton for this attribute

This is most useful for schema or compound attributes, where it will emit
an object or array whose fields are set to null or which is empty.

Returns **any** 

#### defaultsTo

Sets the attributes default value

The default can be a (immutable) value or a function creating a value. The
latter is recommended if the value is something mutable, like an array or
object.

Clones the attribute object.

##### Parameters

-   `newDefault` **[DefaultValue][95]** 

Returns **this** 

#### as

Adds one or more boolean flags

Same as calling `with({'flag1': true, 'flag2': true, ...})`.

Clones the attribute object.

##### Parameters

-   `flags` **...[Array][96]&lt;[string][92]>** 

Returns **this** 

#### with

Adds one or more arbitrary flags

Clones the attribute object.

##### Parameters

-   `flags` **{}** 

Returns **this** 

#### makeOptional

Turns the attribute optional

Clones the attribute object.

Returns **this** 

#### \_clone

Internal method to clone an attribute object

Subclasses must override this method, and call `_copyAttrProps` on the new
instance. Do not call the base implementation.

Returns **[Attribute][97]** 

#### \_copyAttrProps

Internal method that copies internal properties from the given attribute to
this attribute

Used by `_clone`. Subclasses must call the base implementation before copying
their own properties.

The base implementation copies the name, isOptional, default and flags
(as shallow copy). Returns `this`.

##### Parameters

-   `source` **[Attribute][97]** 

Returns **this** 

## Simple Attribute Classes




### FixedAttribute

**Extends Attribute**

Represents a simple fixed value attribute

The comparison is done with the === operator.

#### Parameters

-   `value` **any** 

#### value

The fixed value itself

Type: any

#### valueType

Type of the fixed value

Type: [string][92]

#### \_clone

Clone the attribute

Overrides base implementation

Returns **[FixedAttribute][98]** 

### ObjectAttribute

**Extends Attribute**

Represents an instanceOf-attribute

The class is instantiated with an empty constructor as default.

#### Parameters

-   `Cls` **any** 

#### cls

Class object

Type: any

#### \_clone

Clone the attribute

Overrides base implementation

Returns **[ObjectAttribute][99]** 

## Combined Attribute Classes




### EnumAttribute

**Extends Attribute**

Represents an oneOf-attribute

The first value is used to generate the default.

#### Parameters

-   `values` **[Array][96]&lt;any>** 

#### values

List of valid attributes for this enum

Type: [Array][96]&lt;[Attribute][97]>

#### \_clone

Clone the attribute

Overrides base implementation

Returns **[EnumAttribute][100]** 

### TupleAttribute

**Extends Attribute**

Represents an array attribute with fixed number and type of entries

The default value is an array with default values of each type. The skeleton
is either `null` for optional tuples or an array with all values set to the
skeleton of each type.

#### Parameters

-   `selements` **[Array][96]&lt;any>** 

#### elements

Array of attributes to validate the tuple's contents against

Type: [Array][96]&lt;[Attribute][97]>

#### validate

Main method for validation

Extends base implementation

##### Parameters

-   `input` **any** 

Returns **any** 

#### mergeDefault

Merges the given value with the default of this attribute

Overrides base implementation

##### Parameters

-   `value` **any** 
-   `nullIsUndefined` **[boolean][93]?** 

Returns **any** 

#### newSkeleton

Returns a new skeleton for this attribute

Overrides base implementation

Returns **[Array][96]&lt;any>?** 

#### \_clone

Clone the attribute

Overrides base implementation

Returns **[TupleAttribute][101]** 

### CompoundAttribute

**Extends Attribute**

Represents array and map attributes

Optionally the values can be type-checked as well. Use `ofType` for this.

If the attribute is marked as optional, `newSkeleton` will return null.
Otherwise it creates an empty array or map.

#### Parameters

-   `validator` **[ValidatorFn][94]** 
-   `skeletonMaker` **function (): any** 
-   `iterator` **[ElementIterator][102]** 

#### elementAttr

Attribute that all elements must have

Type: [Attribute][97]?

#### ofType

Bind a type to the contents of the compound attribute

All values of the compound will be validated against the given attribute.

Clones the attribute object.

##### Parameters

-   `spec` **any** 

Returns **this** 

#### validate

Main method for validation

Extends base implementation

##### Parameters

-   `input` **any** 

Returns **any** 

#### newSkeleton

Returns a new skeleton for this attribute

Overrides base implementation

#### \_clone

Clone the attribute

Overrides base implementation

Returns **[CompoundAttribute][103]** 

#### \_copyAttrProps

Copies the attribute's properties

Extends base implementation

##### Parameters

-   `source` **[Attribute][97]** 

Returns **this** 

### SchemaAttribute

**Extends Attribute**

Represents a (plain) object attribute with fields of given types

The default value is an object with default values of each type for each field.
The skeleton is either `null` for optional schemas or an object with all values
set to the skeleton of each type.

#### Parameters

-   `sfields` **{}** 

#### fields

Fields to validate

Type: {}

#### validate

Main method for validation

Extends base implementation

##### Parameters

-   `input` **any** 

Returns **any** 

#### mergeDefault

Merges the given value with the default of this attribute

Overrides base implementation

##### Parameters

-   `value` **any** 
-   `nullIsUndefined` **[boolean][93]?** 

Returns **any** 

#### newSkeleton

Returns a new skeleton for this attribute

Overrides base implementation

#### \_clone

Clone the attribute

Overrides base implementation

Returns **[SchemaAttribute][104]** 

## Functions




### validate

Short-cut to run a validation of the given specification against the given
value

#### Parameters

-   `spec` **any** 
-   `value` **any** 

Returns **any** 

### isValid

Tests a value against a specification

Returns true or false rather than trowing an exception

#### Parameters

-   `spec` **any** 
-   `value` **any** 

Returns **[boolean][93]** 

### newDefault

Short-cut to create a default value for the given specification

#### Parameters

-   `spec` **any** 

Returns **any** 

### mergeDefault

Short-cut to merge the given value into the given specification, filling up
missing values with default values

#### Parameters

-   `spec` **any** 
-   `value` **any** 
-   `nullIsUndefined` **[boolean][93]?** 

Returns **any** 

### newSkeleton

Short-cut to create a skeleton from the given specification

#### Parameters

-   `spec` **any** 

Returns **any** 

### toAttribute

Converts a fixed value or tuple or schema to the respective Attribute object

#### Parameters

-   `v` **any** 

Returns **[Attribute][97]** 

### typeofPlus

A more detailed version of the `typeof` operator

#### Parameters

-   `x` **any** 

Returns **[DetailedType][105]** 

## ValidatorFn

Type: function (input: any): [boolean][93]

## DefaultValue

Type: (function (): any | any)

## ElementValidatorFn

Type: function (element: any, index: ([number][106] \| [string][92])): void

## ElementIterator

Type: function (input: any, elementValidator: [ElementValidatorFn][107]): void

## DetailedType

Result of typeofPlus

Type: (`"undefined"` \| `"number"` \| `"boolean"` \| `"string"` \| `"function"` \| `"regexp"` \| `"array"` \| `"date"` \| `"error"` \| `"null"` \| `"symbol"` \| `"object"`)

[1]: #validated-attributes

[2]: #usage

[3]: #base-classes

[4]: #attributevalidationerror

[5]: #parameters

[6]: #attribute

[7]: #parameters-1

[8]: #name

[9]: #flags

[10]: #default

[11]: #isoptional

[12]: #validate

[13]: #parameters-2

[14]: #newdefault

[15]: #mergedefault

[16]: #parameters-3

[17]: #newskeleton

[18]: #defaultsto

[19]: #parameters-4

[20]: #as

[21]: #parameters-5

[22]: #with

[23]: #parameters-6

[24]: #makeoptional

[25]: #_clone

[26]: #_copyattrprops

[27]: #parameters-7

[28]: #simple-attribute-classes

[29]: #fixedattribute

[30]: #parameters-8

[31]: #value

[32]: #valuetype

[33]: #_clone-1

[34]: #objectattribute

[35]: #parameters-9

[36]: #cls

[37]: #_clone-2

[38]: #combined-attribute-classes

[39]: #enumattribute

[40]: #parameters-10

[41]: #values

[42]: #_clone-3

[43]: #tupleattribute

[44]: #parameters-11

[45]: #elements

[46]: #validate-1

[47]: #parameters-12

[48]: #mergedefault-1

[49]: #parameters-13

[50]: #newskeleton-1

[51]: #_clone-4

[52]: #compoundattribute

[53]: #parameters-14

[54]: #elementattr

[55]: #oftype

[56]: #parameters-15

[57]: #validate-2

[58]: #parameters-16

[59]: #newskeleton-2

[60]: #_clone-5

[61]: #_copyattrprops-1

[62]: #parameters-17

[63]: #schemaattribute

[64]: #parameters-18

[65]: #fields

[66]: #validate-3

[67]: #parameters-19

[68]: #mergedefault-2

[69]: #parameters-20

[70]: #newskeleton-3

[71]: #_clone-6

[72]: #functions

[73]: #validate-4

[74]: #parameters-21

[75]: #isvalid

[76]: #parameters-22

[77]: #newdefault-1

[78]: #parameters-23

[79]: #mergedefault-3

[80]: #parameters-24

[81]: #newskeleton-4

[82]: #parameters-25

[83]: #toattribute

[84]: #parameters-26

[85]: #typeofplus

[86]: #parameters-27

[87]: #validatorfn

[88]: #defaultvalue

[89]: #elementvalidatorfn

[90]: #elementiterator

[91]: #detailedtype

[92]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[93]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[94]: #validatorfn

[95]: #defaultvalue

[96]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[97]: #attribute

[98]: #fixedattribute

[99]: #objectattribute

[100]: #enumattribute

[101]: #tupleattribute

[102]: #elementiterator

[103]: #compoundattribute

[104]: #schemaattribute

[105]: #detailedtype

[106]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[107]: #elementvalidatorfn
